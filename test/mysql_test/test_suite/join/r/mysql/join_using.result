drop table if exists t1,t2;
CREATE TABLE t1 (c1 INT PRIMARY KEY, c2 INT);
CREATE TABLE t2 (c1 INT PRIMARY KEY, c2 INT);
INSERT INTO t1(c1) VALUES (1);
INSERT INTO t2(c1) VALUES (2);
SELECT * FROM t1 INNER JOIN t2 USING (c1);
c1	c2	c2
SELECT * FROM t1 JOIN t2 USING (c1);
c1	c2	c2
SELECT * FROM t1 FULL JOIN t2 USING (c1);
c1	c2	c2
1	NULL	NULL
2	NULL	NULL
SELECT * FROM t1 LEFT JOIN t2 USING (c1);
c1	c2	c2
1	NULL	NULL
SELECT * FROM t1 RIGHT JOIN t2 USING (c1);
c1	c2	c2
2	NULL	NULL
SELECT * FROM t1 CROSS JOIN t2 USING (c1);
c1	c2	c2
DROP TABLE if exists t1,t2,t3;
CREATE TABLE t1 (
c1 INT PRIMARY KEY,
c2 DOUBLE,
c3 VARCHAR(50));
CREATE TABLE t2 (
c1 INT PRIMARY KEY,
c2 DOUBLE,
c3 VARCHAR(50));
CREATE TABLE t3 (
c1 INT PRIMARY KEY,
c2 DOUBLE,
c3 VARCHAR(50));
INSERT INTO t1 VALUES
(1, 1.0, 'ABC'),
(2, 1.0, 'ABC'),
(3, 1.0, 'ABC'),
(4, 1.0, 'ABC');
INSERT INTO t2 VALUES
(1, 1.0, 'DEF'),
(3, 1.0, 'DEF');
INSERT INTO t3 VALUES
(2, 1.0, 'GHI'),
(3, 1.0, 'GHI');
SELECT * FROM t1 LEFT JOIN t2 USING ();
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your OceanBase version for the right syntax to use near ')' at line 1
SELECT * FROM t1 LEFT JOIN t2 USING (c1);
c1	c2	c3	c2	c3
1	1	ABC	1	DEF
2	1	ABC	NULL	NULL
3	1	ABC	1	DEF
4	1	ABC	NULL	NULL
SELECT * FROM t1 LEFT JOIN t2 USING (c2);
c2	c1	c3	c1	c3
1	1	ABC	1	DEF
1	1	ABC	3	DEF
1	2	ABC	1	DEF
1	2	ABC	3	DEF
1	3	ABC	1	DEF
1	3	ABC	3	DEF
1	4	ABC	1	DEF
1	4	ABC	3	DEF
SELECT * FROM t1 LEFT JOIN t2 USING (c1,c3);
c1	c3	c2	c2
1	ABC	1	NULL
2	ABC	1	NULL
3	ABC	1	NULL
4	ABC	1	NULL
SELECT * FROM t1 LEFT JOIN t2 USING (c1,c1);
c1	c2	c3	c2	c3
1	1	ABC	1	DEF
2	1	ABC	NULL	NULL
3	1	ABC	1	DEF
4	1	ABC	NULL	NULL
SELECT * FROM t1 LEFT JOIN t2 USING (c1,c3,c1);
c1	c3	c2	c2
1	ABC	1	NULL
2	ABC	1	NULL
3	ABC	1	NULL
4	ABC	1	NULL
SELECT * FROM t1 RIGHT JOIN t2 USING (c1);
c1	c2	c3	c2	c3
1	1	DEF	1	ABC
3	1	DEF	1	ABC
SELECT * FROM t1 RIGHT JOIN t2 USING (c1,c3);
c1	c3	c2	c2
1	DEF	1	NULL
3	DEF	1	NULL
SELECT * FROM t1 RIGHT JOIN t2 USING (c1,c1);
c1	c2	c3	c2	c3
1	1	DEF	1	ABC
3	1	DEF	1	ABC
SELECT * FROM t1 RIGHT JOIN t2 USING (c1,c3,c1);
c1	c3	c2	c2
1	DEF	1	NULL
3	DEF	1	NULL
SELECT * FROM t1 INNER JOIN t2 USING (c1);
c1	c2	c3	c2	c3
1	1	ABC	1	DEF
3	1	ABC	1	DEF
SELECT * FROM t1 JOIN t2 USING (c1);
c1	c2	c3	c2	c3
1	1	ABC	1	DEF
3	1	ABC	1	DEF
SELECT * FROM t1 FULL JOIN t2 USING (c1);
c1	c2	c3	c2	c3
1	1	ABC	1	DEF
2	1	ABC	NULL	NULL
3	1	ABC	1	DEF
4	1	ABC	NULL	NULL
SELECT t1.c1,t2.c3 FROM t1 INNER JOIN t2 USING (c1);
c1	c3
1	DEF
3	DEF
SELECT t1.c1,t2.c3 FROM t1 JOIN t2 USING (c1);
c1	c3
1	DEF
3	DEF
SELECT t1.c1,t2.c3 FROM t1 FULL JOIN t2 USING (c1);
ERROR HY000: Column part of using clause can not have qualifier
SELECT * FROM t1 JOIN t2 USING (c1) JOIN t3 USING (c2);
ERROR 23000: Column 'c2' in from clause is ambiguous
SELECT * FROM t1 JOIN t2 JOIN t3 USING (c1) USING (c2);
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your OceanBase version for the right syntax to use near 'USING (c2)' at line 1
SELECT * FROM t1 LEFT JOIN t2 USING (c1), t3 WHERE t1.c1 = t3.c1;
c1	c2	c3	c2	c3	c1	c2	c3
2	1	ABC	NULL	NULL	2	1	GHI
3	1	ABC	1	DEF	3	1	GHI
SELECT * FROM t1 LEFT JOIN t2 USING (c1) , t2 z JOIN t3 USING (c1) WHERE t1.c1=z.c1;
c1	c2	c3	c2	c3	c1	c2	c3	c2	c3
3	1	ABC	1	DEF	3	1	DEF	1	GHI
SELECT * FROM t1 m JOIN t2 USING (c1);
c1	c2	c3	c2	c3
1	1	ABC	1	DEF
3	1	ABC	1	DEF
SELECT * FROM t1 m JOIN t2 n USING (c1);
c1	c2	c3	c2	c3
1	1	ABC	1	DEF
3	1	ABC	1	DEF
SELECT m.c1 x, n.c3 y FROM t1 m JOIN t2 n USING (c1);
x	y
1	DEF
3	DEF
DROP TABLE t1,t2,t3;
