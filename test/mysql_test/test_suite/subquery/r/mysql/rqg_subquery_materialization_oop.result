DROP TABLE IF EXISTS  B;
CREATE TABLE B (
col_varchar_10_key varchar(10),
pk int,
col_datetime_key datetime,
col_date_key date,
col_varchar_20_key varchar(20),
col_date date,
col_varchar_10 varchar(10),
col_varchar_20 varchar(20),
col_int_key int,
col_datetime datetime,
col_int int,
/*Indices*/
key idx3(col_varchar_10_key ),
primary key (pk),
key idx9(col_datetime_key ),
key idx7(col_date_key ),
key idx5(col_varchar_20_key ),
key idx1(col_int_key )) ;
INSERT INTO B VALUES  ('kkp', 1, '2004-10-16 00:57:16', '2004-01-14 09:42:56', 'REEQA', '2000-05-07 20:53:16', 't', 'RJWCV', NULL, '2004-08-27 11:24:22', NULL) ;
COMMIT;
DROP TABLE IF EXISTS  C;
CREATE TABLE C (
col_varchar_10_key varchar(10),
col_date_key date,
col_varchar_20 varchar(20),
col_datetime datetime,
pk int,
col_datetime_key datetime,
col_int_key int,
col_varchar_10 varchar(10),
col_int int,
col_date date,
col_varchar_20_key varchar(20),
/*Indices*/
key idx3(col_varchar_10_key ),
key idx7(col_date_key ),
primary key (pk),
key idx9(col_datetime_key ),
key idx1(col_int_key ),
key idx5(col_varchar_20_key )) ;
INSERT INTO C VALUES  ('m', '2009-05-26 08:23:35', 'ekkpo', '2008-03-08 07:14:41', 1, '2009-08-02 20:27:19', NULL, 'm', NULL, '2000-09-07 13:19:46', 'x') ,  ('WQNOL', '2000-07-21 17:07:25', 'NVCLE', '2006-07-26 20:52:57', 2, '2001-01-13 04:08:55', 1, 'that', NULL, '2002-07-10 00:05:57', 'r') ;
COMMIT;
DROP TABLE IF EXISTS  BB;
CREATE TABLE BB (
pk int,
col_date date,
col_int int,
col_datetime datetime,
col_int_key int,
col_varchar_10 varchar(10),
col_varchar_20_key varchar(20),
col_varchar_10_key varchar(10),
col_datetime_key datetime,
col_date_key date,
col_varchar_20 varchar(20),
/*Indices*/
primary key (pk),
key idx1(col_int_key ),
key idx5(col_varchar_20_key ),
key idx3(col_varchar_10_key ),
key idx9(col_datetime_key ),
key idx7(col_date_key )) ;
INSERT INTO BB VALUES  (1, '2003-04-23 18:41:16', 6, '2005-10-24 18:18:51', NULL, 'cwakbywrvs', 'u', 'don\'t', '2004-11-12 13:38:24', '2006-07-05 09:53:27', 'dcwakbyw') ,  (2, '2003-03-22 22:28:58', 2078998528, '2005-09-18 22:12:43', 1550974976, 'udc', 'WBKOU', 'HZHFS', '2000-04-25 09:07:11', '2001-09-13 00:42:07', 'IORCN') ,  (3, '2001-09-14 17:35:49', 4, '2005-03-07 05:20:49', 1091305472, 'NFLSW', 'her', 'out', '2005-02-02 14:47:19', '2007-01-20 03:29:40', 'tudc') ,  (4, '2006-01-01 23:25:41', NULL, '2000-11-12 21:13:27', 1665990656, 'LYLSS', 'otu', 'fotudcw', '2004-09-03 11:49:01', '2009-01-27 09:15:41', 'n') ,  (5, '2004-02-02 20:08:21', 2061369344, '2004-08-15 04:50:15', 1711734784, 'hfotudc', 'you\'re', 'khfot', '2004-08-03 23:41:18', '2000-01-22 17:43:03', 'vkhfotu') ,  (6, '2008-09-10 14:06:23', NULL, '2009-09-14 09:57:06', NULL, 'kvkhfot', 'bkvkhfo', 'x', '2004-01-21 19:21:48', '2007-10-20 07:39:44', 'FHWWV') ,  (7, '2003-07-04 00:34:31', NULL, '2008-07-27 01:31:54', -106692608, 'how', 'pbkvkh', 'i', '2000-05-07 05:59:07', '2000-11-27 00:01:21', 'DYXZD') ,  (8, '2007-03-15 19:03:40', NULL, '2002-12-08 17:54:25', 2, 'YXRPH', 'or', 'r', '2002-07-21 02:23:52', '2007-08-16 01:57:46', 'is') ,  (9, '2002-07-15 23:38:00', NULL, '2004-07-17 00:37:31', NULL, 'q', 'GFJQM', 'UZSQL', '2009-04-17 16:08:23', '2002-11-13 10:10:01', 'YGWXF') ,  (10, '2008-06-16 09:37:06', NULL, '2005-05-01 10:31:43', NULL, 'i', 'RUTYP', 'going', '2005-10-28 05:29:47', '2000-10-18 18:00:15', 'wpbkvkhf') ,  (11, '2009-01-27 05:17:20', -1565130752, '2006-01-07 01:49:08', NULL, 'FVHBX', 'k', 'back', '2007-06-04 02:44:36', '2006-04-17 11:51:02', 'my') ,  (12, '2008-09-24 18:38:14', -2060648448, '2009-11-13 13:17:05', NULL, 'x', 'ewp', 'a', '2007-11-03 14:29:08', '2007-05-01 14:13:50', 'e') ,  (13, '2008-01-24 14:22:57', NULL, '2002-11-26 19:45:28', 7, 'r', 'vewpbkvkh', 'l', '2009-07-10 13:35:54', '2008-01-25 01:56:47', 'he') ,  (14, '2008-04-25 00:17:00', NULL, '2006-03-07 23:02:00', NULL, 'cvewpb', 'or', 'ecvewpb', '2005-11-04 03:58:04', '2005-10-11 20:09:24', 'x') ,  (15, '2004-10-07 20:19:35', 1, '2008-01-04 05:10:39', 726663168, 'from', 'm', 'g', '2001-12-17 22:26:20', '2008-05-19 07:39:44', 'ZWYWB') ,  (16, '2001-09-06 07:16:23', 3, '2009-06-19 15:09:57', 2, 'o', 'here', 'o', '2006-07-01 11:55:01', '2006-01-27 17:54:25', 'GBCEX') ,  (17, '2008-03-06 09:09:32', 3, '2001-06-04 04:13:34', NULL, 'PUMFK', 'p', 'a', '2009-04-26 05:19:51', '2007-02-23 03:34:16', 'x') ,  (18, '2006-12-21 18:11:00', -404226048, '2004-06-11 08:48:52', 1, 'a', 'fecv', 'will', '2008-08-23 20:26:27', '2002-06-24 09:11:02', 'w') ,  (19, '2002-10-08 05:53:04', 2120482816, '2000-12-17 19:34:45', NULL, 'rwfecvew', 'ASJFE', 'zrw', '2004-07-25 04:19:45', '2006-09-20 19:38:40', 'QJNIQ') ,  (20, '2006-09-13 10:03:21', -1152385024, '2002-05-03 02:10:39', -15466496, 'k', 'fkzrwfec', 'u', '2004-06-04 00:06:00', '2007-04-08 02:38:52', 'VTLYL') ,  (21, '2000-03-08 22:50:32', -616038400, '2009-04-10 10:17:42', -1163395072, 'YKTPU', 'YDZSJ', 'with', '2006-08-25 05:45:16', '2005-07-18 21:14:55', 'sfkzrwf') ,  (22, '2002-05-27 21:53:54', 1513816064, '2002-08-09 18:52:10', 1348403200, 'h', 'going', 'VALIW', '2008-07-14 13:29:27', '2008-01-11 05:06:30', 'MZOIR') ,  (23, '2002-10-20 19:07:26', 5, '2004-01-25 07:30:01', NULL, 'UDIUZ', 'right', 'o', '2007-10-26 01:17:12', '2009-11-15 09:18:18', 'BERZH') ,  (24, '2001-07-01 02:58:05', NULL, '2001-03-05 15:25:43', 1, 'd', 'did', 'tsf', '2009-10-03 18:08:36', '2003-03-13 14:00:41', 'atsfkzr') ,  (25, '2003-05-10 04:15:51', 286654464, '2004-07-13 12:36:34', -1463091200, 'WNBRB', 'AYTIL', 'r', '2003-11-03 16:33:16', '2005-10-26 18:35:00', 'p') ,  (26, '2008-03-21 04:56:31', NULL, '2000-10-17 04:18:14', 233897984, 'hats', 'ahatsfkz', 'time', '2009-10-01 10:33:01', '2004-09-10 07:43:53', 'p') ,  (27, '2008-12-12 05:01:00', NULL, '2004-01-02 23:20:33', 7, 'NQKCO', 'TVTTB', 'KJYNW', '2000-05-06 14:41:27', '2003-11-28 23:04:01', 'yahatsfkz') ,  (28, '2005-09-08 16:11:04', NULL, '2002-03-05 17:07:00', NULL, 'i', 'e', 'fyahat', '2008-03-18 11:56:51', '2004-04-21 21:18:29', 'i') ;
COMMIT;
SELECT  DISTINCT OUTR . `col_varchar_20` AS X FROM C AS OUTR2 LEFT JOIN B AS OUTR ON ( OUTR2 . `col_varchar_20` <> OUTR . `col_varchar_20` ) WHERE OUTR . `col_varchar_10` IN ( SELECT  DISTINCT INNR . `col_varchar_20` AS Y FROM BB AS INNR2 LEFT JOIN BB AS INNR ON ( INNR2 . `col_date_key` = INNR . `col_date_key` ) WHERE INNR . `col_date_key` = INNR . `col_datetime_key` AND OUTR . `pk` IS NOT NULL ORDER BY INNR . `col_int` ) OR ( OUTR . `pk` > 8 AND NOT OUTR . `col_int_key` < 0 ) HAVING X >= '2002-01-19 16:26:37' ORDER BY OUTR . `col_int_key` , OUTR . `pk`;
X
