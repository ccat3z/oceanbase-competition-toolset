DROP TABLE IF EXISTS t1, t2;
CREATE TABLE t1 (id INTEGER);
CREATE TABLE t2 (id INTEGER);
INSERT INTO t1 (id) VALUES (1), (1), (1),(1);
SELECT AVG(DISTINCT id) FROM t1 GROUP BY id % 13;
AVG(DISTINCT id)
1.0000
SELECT SUM(DISTINCT id)/COUNT(DISTINCT id) FROM t1 GROUP BY id % 13;
SUM(DISTINCT id)/COUNT(DISTINCT id)
1.0000
SELECT SUM(DISTINCT id) sm FROM t1;
sm
1
SELECT SUM(DISTINCT id) sm FROM t2;
sm
NULL
SELECT SUM(DISTINCT id) sm FROM t1 group by id % 13;
sm
1
SELECT SUM(DISTINCT id) sm FROM t1;
sm
1
SELECT SUM(DISTINCT id) sm FROM t2;
sm
NULL
SELECT SUM(DISTINCT id) sm FROM t1 GROUP BY id % 13;
sm
1
DROP TABLE t1;
DROP TABLE t2;
