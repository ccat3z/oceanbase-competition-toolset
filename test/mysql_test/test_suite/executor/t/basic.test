# tags: optimizer
# merged by case basic, join_x1, join_x2 and full_join

--source mysql_test/test_suite/executor/include/cleanup.inc
--source mysql_test/test_suite/executor/include/load_data.inc

--result_format 4

################################
# basic
# all kinds of receive.

# fifo receive
select b, sum(a) from t_h3_01_20 group by b having sum(a) between 5 and 16 order by b;
select b, sum(a) from t_h5_09_28 group by b having sum(a) between 13 and 24 order by b desc;
select b, sum(a) from t_r4_01_20 group by b having sum(a) between 5 and 16 order by b;
select b, sum(a) from t_r5_09_28 group by b having sum(a) between 13 and 24 order by b desc;
select b, sum(a) from t_h3_r4_01_20 group by b having sum(a) between 5 and 16 order by b;
select b, sum(a) from t_h3_r5_09_28 group by b having sum(a) between 13 and 24 order by b desc;
select b, sum(a) from t_h5_r4_01_20 group by b having sum(a) between 5 and 16 order by b;
select b, sum(a) from t_h5_r5_09_28 group by b having sum(a) between 13 and 24 order by b desc;
# task order receive
select a, b from t_r4_01_20 where a between 5 and 16 order by a;
select a, b from t_r4_09_28 where a between 13 and 24 order by a desc;
select a, b from t_r5_01_20 where a between 5 and 16 order by a;
select a, b from t_r5_09_28 where a between 13 and 24 order by a desc;
select a, b from t_h3_r4_01_20 where a = 12 order by b;
select a, b from t_h3_r5_09_28 where a = 12 order by b desc;
select a, b from t_h5_r4_01_20 where a = 12 order by b;
select a, b from t_h5_r5_09_28 where a = 12 order by b desc;
# merge sort receive
select a, b from t_h3_01_20 where a between 5 and 16 order by b;
select a, b from t_h5_09_28 where a between 13 and 24 order by b desc;
select a, b from t_r4_01_20 where a between 5 and 16 order by b;
select a, b from t_r4_09_28 where a between 13 and 24 order by b desc;
select a, b from t_h3_r4_01_20 where a between 5 and 16 order by b;
select a, b from t_h3_r5_09_28 where a between 13 and 24 order by b desc;
select a, b from t_h5_r4_01_20 where a between 5 and 16 order by b;
select a, b from t_h5_r5_09_28 where a between 13 and 24 order by b desc;

## check if result_type_classes of join_keys are the same when repart
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.aa;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.a;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.b;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.c;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.d;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.e;


--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.aa;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.a;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.b;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.c;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.d;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.e;

--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.a;
--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.b;
--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.d;
--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.e;

--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.a;
--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.b;
--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.d;
--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.e;

--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.a;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.aa;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.b;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.bb;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.c;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.d;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.e;


--sorted_result
select * from t_r4_int t1, t_r4_int as t2 where t1.a = t2.a;
--sorted_result
select * from t_r4_int t1, t_r4_date as t2 where t1.a = t2.c;
--sorted_result
select * from t_r4_int t1, t_r4_datetime as t2 where t1.a = t2.c;
--sorted_result
select * from t_r4_int t1, t_r4_timestamp as t2 where t1.a = t2.c;


--sorted_result
select * from t_r4_date t1, t_r4_int as t2 where t1.c = t2.a;
--sorted_result
select * from t_r4_date t1, t_r4_date as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_date t1, t_r4_datetime as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_date t1, t_r4_timestamp as t2 where t1.c = t2.c;

--sorted_result
select * from t_r4_datetime t1, t_r4_int as t2 where t1.c = t2.a;
--sorted_result
select * from t_r4_datetime t1, t_r4_date as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_datetime t1, t_r4_datetime as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_datetime t1, t_r4_timestamp as t2 where t1.c = t2.c;

--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.aa;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.a;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.b;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.c;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.d;
--sorted_result
select * from t_h5_int t1, t_refered as t2 where t1.a = t2.e;

--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.aa;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.a;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.b;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.c;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.d;
--sorted_result
select * from t_r4_int t1, t_refered as t2 where t1.a = t2.e;

--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.a;
--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.b;
--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.d;
--sorted_result
select * from t_r4_date t1, t_refered as t2 where t1.c = t2.e;

--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.a;
--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.b;
--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.d;
--sorted_result
select * from t_r4_datetime t1, t_refered as t2 where t1.c = t2.e;


--sorted_result
select * from t_h5_r4_int_int t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a;
--sorted_result
select * from t_h5_r4_int_int t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.aa;
--sorted_result
select * from t_h5_r4_int_int t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.b;
--sorted_result
select * from t_h5_r4_int_int t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.c;
--sorted_result
select * from t_h5_r4_int_int t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.d;
--sorted_result
select * from t_h5_r4_int_int t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.e;

--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.a;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.aa;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.b;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.bb;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.c;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.d;
--sorted_result
select * from t_h5_r4_int_int_datetime t1, t_refered as t2 where t1.a = t2.a and t1.b=t2.a and t1.c = t2.e;

--sorted_result
select * from t_r4_int t1, t_r4_int  as t2 where t1.a = t2.a;
--sorted_result
select * from t_r4_int t1, t_r4_date  as t2 where t1.a = t2.c;
--sorted_result
select * from t_r4_int t1, t_r4_datetime  as t2 where t1.a = t2.c;
--sorted_result
select * from t_r4_int t1, t_r4_timestamp  as t2 where t1.a = t2.c;


--sorted_result
select * from t_r4_date t1, t_r4_int  as t2 where t1.c = t2.a;
--sorted_result
select * from t_r4_date t1, t_r4_date  as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_date t1, t_r4_datetime  as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_date t1, t_r4_timestamp  as t2 where t1.c = t2.c;

--sorted_result
select * from t_r4_datetime t1, t_r4_int  as t2 where t1.c = t2.a;
--sorted_result
select * from t_r4_datetime t1, t_r4_date  as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_datetime t1, t_r4_datetime  as t2 where t1.c = t2.c;
--sorted_result
select * from t_r4_datetime t1, t_r4_timestamp  as t2 where t1.c = t2.c;


# additional case for task order with many range part.

select min(a) from t_many_range_part where a >=  1;
select min(a) from t_many_range_part where a >=  6;
select min(a) from t_many_range_part where a >= 11;
select min(a) from t_many_range_part where a >= 16;
select min(a) from t_many_range_part where a >= 21;
select min(a) from t_many_range_part where a >= 26;
select min(a) from t_many_range_part where a >= 31;
select min(a) from t_many_range_part where a >= 36;
select min(a) from t_many_range_part where a >= 41;
select min(a) from t_many_range_part where a >= 46;

select max(a) from t_many_range_part where a >=  1;
select max(a) from t_many_range_part where a >=  6;
select max(a) from t_many_range_part where a >= 11;
select max(a) from t_many_range_part where a >= 16;
select max(a) from t_many_range_part where a >= 21;
select max(a) from t_many_range_part where a >= 26;
select max(a) from t_many_range_part where a >= 31;
select max(a) from t_many_range_part where a >= 36;
select max(a) from t_many_range_part where a >= 41;
select max(a) from t_many_range_part where a >= 46;

select a from t_many_range_part where a >=  1 order by a asc limit 10;
select a from t_many_range_part where a >=  6 order by a asc limit 10;
select a from t_many_range_part where a >= 11 order by a asc limit 10;
select a from t_many_range_part where a >= 16 order by a asc limit 10;
select a from t_many_range_part where a >= 21 order by a asc limit 10;
select a from t_many_range_part where a >= 26 order by a asc limit 10;
select a from t_many_range_part where a >= 31 order by a asc limit 10;
select a from t_many_range_part where a >= 36 order by a asc limit 10;
select a from t_many_range_part where a >= 41 order by a asc limit 10;
select a from t_many_range_part where a >= 46 order by a asc limit 10;

select a from t_many_range_part where a >=  1 order by a desc limit 10;
select a from t_many_range_part where a >=  6 order by a desc limit 10;
select a from t_many_range_part where a >= 11 order by a desc limit 10;
select a from t_many_range_part where a >= 16 order by a desc limit 10;
select a from t_many_range_part where a >= 21 order by a desc limit 10;
select a from t_many_range_part where a >= 26 order by a desc limit 10;
select a from t_many_range_part where a >= 31 order by a desc limit 10;
select a from t_many_range_part where a >= 36 order by a desc limit 10;
select a from t_many_range_part where a >= 41 order by a desc limit 10;
select a from t_many_range_part where a >= 46 order by a desc limit 10;

# tags: optimizer

################################
# 1 inner join

# wise join
# 0 exchange in distributed job.
# nestedloop join
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 inner join t_h3_09_28 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 inner join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 inner join t_r4_01_20 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 inner join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 inner join t_h3_r4_01_20 t2 on t1.a = t2.a and t1.b = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_r5_09_28 t1 inner join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
# merge join
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 inner join t_h3_09_28 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 inner join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 inner join t_r4_01_20 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 inner join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 inner join t_h3_r4_01_20 t2 on t1.a = t2.a and t1.b = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_r5_09_28 t1 inner join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
# hash join
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 inner join t_h3_09_28 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 inner join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 inner join t_r4_01_20 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 inner join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 inner join t_h3_r4_01_20 t2 on t1.a = t2.a and t1.b = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_r5_09_28 t1 inner join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;

# normal join
# 1 exchange in distributed job.
# nestedloop join
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 inner join t_h5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 inner join t_h3_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 inner join t_r5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 inner join t_r4_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 inner join t_r4_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 inner join t_r5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 inner join t_h3_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 inner join t_h5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 inner join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 inner join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 inner join t_h5_r5_09_28 t2 on t1.d = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 inner join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.d where t1.a between 13 and 24 order by t1.a, t2.a;
# merge join
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 inner join t_h5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 inner join t_h3_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 inner join t_r5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 inner join t_r4_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 inner join t_r4_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 inner join t_r5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 inner join t_h3_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 inner join t_h5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 inner join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 inner join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 inner join t_h5_r5_09_28 t2 on t1.d = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 inner join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.d where t1.a between 13 and 24 order by t1.a, t2.a;
# hash join
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 inner join t_h5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 inner join t_h3_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 inner join t_r5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 inner join t_r4_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 inner join t_r4_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 inner join t_r5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 inner join t_h3_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 inner join t_h5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 inner join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 inner join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 inner join t_h5_r5_09_28 t2 on t1.d = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 inner join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.d where t1.a between 13 and 24 order by t1.a, t2.a;

################################
# 1 left join

# wise join
# 0 exchange in distributed job.
# nestedloop join
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_h3_09_28 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 left join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_r4_01_20 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 left join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 left join t_h3_r4_01_20 t2 on t1.a = t2.a and t1.b = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_r5_09_28 t1 left join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
# merge join
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_h3_09_28 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 left join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_r4_01_20 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 left join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 left join t_h3_r4_01_20 t2 on t1.a = t2.a and t1.b = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_r5_09_28 t1 left join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
# hash join
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_h3_09_28 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 left join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_r4_01_20 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 left join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 left join t_h3_r4_01_20 t2 on t1.a = t2.a and t1.b = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_r5_09_28 t1 left join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;

# normal join
# 1 exchange in distributed job.
# nestedloop join
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_h5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 left join t_h3_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_h5_09_28 t2 on t1.b = t2.a and t2.a in (1, 2, 6, 7) where t1.a = 3 order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_r5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 left join t_r4_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_r5_09_28 t2 on t1.b = t2.a and t2.a between 20 and 28 where t1.a = 1 order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_r4_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 left join t_r5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_r4_09_28 t2 on t1.b = t2.a and t2.a between 20 and 28 where t1.a = 1 order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_h3_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 left join t_h5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_h3_09_28 t2 on t1.b = t2.a and t2.a in (1, 2) where t1.a = 3 order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 left join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 left join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 left join t_h5_r5_09_28 t2 on t1.d = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 left join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.d where t1.a between 13 and 24 order by t1.a, t2.a;
# merge join
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_h5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 left join t_h3_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_h5_09_28 t2 on t1.b = t2.a and t2.a in (1, 2, 6, 7) where t1.a = 3 order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_r5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 left join t_r4_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_r5_09_28 t2 on t1.b = t2.a and t2.a between 20 and 28 where t1.a = 1 order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_r4_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 left join t_r5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_r4_09_28 t2 on t1.b = t2.a and t2.a between 20 and 28 where t1.a = 1 order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_h3_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 left join t_h5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_h3_09_28 t2 on t1.b = t2.a and t2.a in (1, 2) where t1.a = 3 order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 left join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 left join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 left join t_h5_r5_09_28 t2 on t1.d = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 left join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.d where t1.a between 13 and 24 order by t1.a, t2.a;
# hash join
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_h5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 left join t_h3_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_h5_09_28 t2 on t1.b = t2.a and t2.a in (1, 2, 6, 7) where t1.a = 3 order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_r5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 left join t_r4_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_r5_09_28 t2 on t1.b = t2.a and t2.a between 20 and 28 where t1.a = 1 order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_r4_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 left join t_r5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 left join t_r4_09_28 t2 on t1.b = t2.a and t2.a between 20 and 28 where t1.a = 1 order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_h3_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 left join t_h5_09_28 t2 on t1.b = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 left join t_h3_09_28 t2 on t1.b = t2.a and t2.a in (1, 2) where t1.a = 3 order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 left join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 left join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 left join t_h5_r5_09_28 t2 on t1.d = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 left join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.d where t1.a between 13 and 24 order by t1.a, t2.a;

################################
# 1 right join

# wise join
# 0 exchange in distributed job.
# nestedloop join
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_h3_09_28 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 right join t_h5_09_28 t2 on t1.a = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_r4_01_20 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 right join t_r5_09_28 t2 on t1.a = t2.a where t2.a between 13 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 right join t_h3_r4_01_20 t2 on t1.a = t2.a and t1.b = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_r5_09_28 t1 right join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
# merge join
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_h3_09_28 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 right join t_h5_09_28 t2 on t1.a = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_r4_01_20 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 right join t_r5_09_28 t2 on t1.a = t2.a where t2.a between 13 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 right join t_h3_r4_01_20 t2 on t1.a = t2.a and t1.b = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_r5_09_28 t1 right join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
# hash join
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_h3_09_28 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 right join t_h5_09_28 t2 on t1.a = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_r4_01_20 t2 on t1.a = t2.a order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 right join t_r5_09_28 t2 on t1.a = t2.a where t2.a between 13 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 right join t_h3_r4_01_20 t2 on t1.a = t2.a and t1.b = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_r5_09_28 t1 right join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;

# normal join
# 1 exchange in distributed job.
# nestedloop join
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_h5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 right join t_h3_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_h5_09_28 t2 on t1.a = t2.b and t1.a in (1, 2) where t2.a = 27 order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_r5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 right join t_r4_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_r5_09_28 t2 on t1.a = t2.b and t1.a between 1 and 10 where t2.a = 28 order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_r4_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 right join t_r5_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_r4_09_28 t2 on t1.a = t2.b and t1.a in (1, 2) where t2.a = 27 order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_h3_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 right join t_h5_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_h3_09_28 t2 on t1.a = t2.b and t1.a between 1 and 10 where t2.a = 28 order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 right join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 right join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 right join t_h5_r5_09_28 t2 on t1.d = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 right join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.d where t1.a between 13 and 24 order by t1.a, t2.a;
# merge join
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_h5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 right join t_h3_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_h5_09_28 t2 on t1.a = t2.b and t1.a in (1, 2) where t2.a = 27 order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_r5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 right join t_r4_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_r5_09_28 t2 on t1.a = t2.b and t1.a between 1 and 10 where t2.a = 28 order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_r4_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 right join t_r5_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_r4_09_28 t2 on t1.a = t2.b and t1.a in (1, 2) where t2.a = 27 order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_h3_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 right join t_h5_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_h3_09_28 t2 on t1.a = t2.b and t1.a between 1 and 10 where t2.a = 28 order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 right join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 right join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 right join t_h5_r5_09_28 t2 on t1.d = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_merge(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 right join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.d where t1.a between 13 and 24 order by t1.a, t2.a;
# hash join
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_h5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 right join t_h3_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_h5_09_28 t2 on t1.a = t2.b and t1.a in (1, 2) where t2.a = 27 order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_r5_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 right join t_r4_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_r5_09_28 t2 on t1.a = t2.b and t1.a between 1 and 10 where t2.a = 28 order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_r4_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 right join t_r5_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 right join t_r4_09_28 t2 on t1.a = t2.b and t1.a in (1, 2) where t2.a = 27 order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_h3_09_28 t2 on t1.a = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 right join t_h5_09_28 t2 on t1.b = t2.a where t2.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 right join t_h3_09_28 t2 on t1.a = t2.b and t1.a between 1 and 10 where t2.a = 28 order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 right join t_h5_r5_09_28 t2 on t1.a = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 right join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.b where t1.a between 13 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r4_01_20 t1 right join t_h5_r5_09_28 t2 on t1.d = t2.a and t1.c = t2.b order by t1.a desc, t2.a desc;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_r5_09_28 t1 right join t_h5_r4_01_20 t2 on t1.a = t2.c and t1.b = t2.d where t1.a between 13 and 24 order by t1.a, t2.a;

################################
# join_x2 2 inner join

# 2 wise join
# 0 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 inner join t_h3_05_24 t2 on t1.a = t2.a inner join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 inner join t_h5_05_24 t2 on t1.a = t2.a inner join t_h5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;
# 暂时不是wise join
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 inner join t_r4_01_20 t2 on t1.a = t2.a inner join t_r4_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_09_28 t1 inner join t_r5_09_28 t2 on t1.a = t2.a inner join t_r5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;

# 1 wise join + 1 normal join
# 1 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 inner join t_h3_05_24 t2 on t1.a = t2.a inner join t_h5_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 inner join t_h5_05_24 t2 on t1.a = t2.a inner join t_r4_09_28 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
# 暂时不是wise join
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 inner join t_r4_01_20 t2 on t1.a = t2.a inner join t_r5_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_09_28 t1 inner join t_r5_09_28 t2 on t1.a = t2.a inner join t_h3_01_20 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;

# 2 normal join
# 2 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 inner join t_h5_05_24 t2 on t1.a = t2.a inner join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 inner join t_h3_05_24 t2 on t1.a = t2.a inner join t_r4_09_28 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 inner join t_r5_05_24 t2 on t1.a = t2.a inner join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 inner join t_h3_05_24 t2 on t1.b = t2.a inner join t_h5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_09_28 t1 inner join t_r5_05_24 t2 on t1.a = t2.a inner join t_r4_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_09_28 t1 inner join t_r4_05_24 t2 on t1.a = t2.a inner join t_h3_01_20 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_09_28 t1 inner join t_h5_05_24 t2 on t1.a = t2.a inner join t_r4_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_09_28 t1 inner join t_r4_05_24 t2 on t1.b = t2.a inner join t_h3_01_20 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;

################################
# 1 inner join + 1 outer join

# 2 wise join
# 0 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 inner join t_h3_05_24 t2 on t1.a = t2.a left join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a inner join t_h5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;
# 暂时不是wise join
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 inner join t_r4_01_20 t2 on t1.a = t2.a right join t_r4_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_09_28 t1 right join t_r5_09_28 t2 on t1.a = t2.a inner join t_r5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;

# 1 wise join + 1 normal join
# 1 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 inner join t_h3_05_24 t2 on t1.a = t2.a left join t_h5_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a inner join t_r4_09_28 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
# 暂时不是wise join
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 inner join t_r4_01_20 t2 on t1.a = t2.a right join t_r5_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_09_28 t1 left join t_r5_09_28 t2 on t1.a = t2.a inner join t_h3_01_20 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;

# 2 normal join
# 2 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 inner join t_h5_05_24 t2 on t1.a = t2.a left join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 left join t_h3_05_24 t2 on t1.a = t2.a inner join t_r4_09_28 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 inner join t_r5_05_24 t2 on t1.a = t2.a right join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 right join t_h3_05_24 t2 on t1.b = t2.a inner join t_h5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_09_28 t1 inner join t_r5_05_24 t2 on t1.a = t2.a left join t_r4_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_09_28 t1 left join t_r4_05_24 t2 on t1.a = t2.a inner join t_h3_01_20 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_09_28 t1 inner join t_h5_05_24 t2 on t1.a = t2.a right join t_r4_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_09_28 t1 right join t_r4_05_24 t2 on t1.b = t2.a inner join t_h3_01_20 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;

################################
# 2 outer join

# 2 wise join
# 0 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 left join t_h3_05_24 t2 on t1.a = t2.a left join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a right join t_h5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 right join t_h5_05_24 t2 on t1.a = t2.a right join t_h5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 right join t_h5_05_24 t2 on t1.a = t2.a right join t_h5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;
# 暂时不是wise join
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 left join t_r4_01_20 t2 on t1.a = t2.a left join t_r4_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_09_28 t1 left join t_r4_09_28 t2 on t1.a = t2.a right join t_r4_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_01_20 t1 left join t_r5_01_20 t2 on t1.a = t2.a right join t_r5_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_09_28 t1 right join t_r5_09_28 t2 on t1.a = t2.a right join t_r5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;

# 1 wise join + 1 normal join
# 1 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a right join t_r4_09_28 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a right join t_r4_09_28 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 right join t_h3_05_24 t2 on t1.a = t2.a left join t_h5_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 right join t_h5_05_24 t2 on t1.a = t2.a right join t_r4_09_28 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
# 暂时不是wise join
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 left join t_r4_01_20 t2 on t1.a = t2.a left join t_h3_05_24 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_09_28 t1 left join t_r4_09_28 t2 on t1.a = t2.a right join t_r5_05_24 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_01_20 t1 left join t_r5_01_20 t2 on t1.a = t2.a right join t_h3_05_24 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_09_28 t1 right join t_r5_09_28 t2 on t1.a = t2.a right join t_r4_05_24 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;

# 2 normal join with t1+t3 or t2+t3 can wise join
# 2 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a left join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 left join t_h5_05_24 t2 on t1.b = t2.a right join t_h5_09_28 t3 on t2.a = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 right join t_r4_05_24 t2 on t1.a = t2.a left join t_h5_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 right join t_r4_05_24 t2 on t1.b = t2.a right join t_r4_05_24 t3 on t2.a = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a left join t_r4_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 left join t_h5_05_24 t2 on t1.b = t2.a right join t_h5_09_28 t3 on t2.a = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_01_20 t1 right join t_r4_05_24 t2 on t1.a = t2.a left join t_r5_01_20 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_01_20 t1 right join t_r4_05_24 t2 on t1.b = t2.a right join t_r4_05_24 t3 on t2.a = t3.a order by t1.a, t2.a, t3.a;

# 2 normal join with any 2 tables can not wise join
# 2 exchange in distributed job.
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a left join t_r4_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h3_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a right join t_r5_09_28 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 right join t_r4_05_24 t2 on t1.a = t2.a left join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_h5_01_20 t1 right join t_r4_05_24 t2 on t1.b = t2.a right join t_r5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a left join t_h3_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r4_01_20 t1 left join t_h5_05_24 t2 on t1.a = t2.a right join t_r5_09_28 t3 on t1.b = t3.a order by t1.a, t2.a, t3.a;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_01_20 t1 right join t_r4_05_24 t2 on t1.a = t2.a left join t_h5_09_28 t3 on t1.a = t3.a order by t1.a desc, t2.a desc, t3.a desc;
select /*+leading(t1 t2 t3)*/ t1.a, t2.a, t3.a from t_r5_01_20 t1 right join t_r4_05_24 t2 on t1.b = t2.a right join t_r5_09_28 t3 on t1.a = t3.a order by t1.a, t2.a, t3.a;


set @@ob_enable_transformation=0;
################################
# full_join 1 full join

# wise join
# 0 exchange in distributed job.
# nestedloop jion
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 full join t_h3_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 full join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
# 暂时不是wise join
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 full join t_r4_01_20 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 full join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 13 and 24 order by t1.a, t2.a;
# merge jion
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 full join t_h3_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 full join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
# 暂时不是wise join
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 full join t_r4_01_20 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 full join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 13 and 24 order by t1.a, t2.a;
# hash jion
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 full join t_h3_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 full join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
# 暂时不是wise join
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 full join t_r4_01_20 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_09_28 t1 full join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 13 and 24 order by t1.a, t2.a;

# normal join
# 1 exchange in distributed job.
# nestedloop jion
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 full join t_h5_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 full join t_h3_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 full join t_r5_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 full join t_r4_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 full join t_r4_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 full join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 full join t_h3_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_nl(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 full join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
# merge jion
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 full join t_h5_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 full join t_h3_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 full join t_r5_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 full join t_r4_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 full join t_r4_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 full join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 full join t_h3_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_mj(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 full join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
# hash jion
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 full join t_h5_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 full join t_h3_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 full join t_r5_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 full join t_r4_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h3_01_20 t1 full join t_r4_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_h5_01_20 t1 full join t_r5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r4_01_20 t1 full join t_h3_09_28 t2 on t1.a = t2.a order by t1.a, t2.a;
select /*+use_hash(t1 t2)*/ t1.a, t2.a from t_r5_01_20 t1 full join t_h5_09_28 t2 on t1.a = t2.a where t1.a between 5 and 24 order by t1.a, t2.a;

--source mysql_test/test_suite/executor/include/cleanup.inc
